<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Menu Module</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">

        <!-- ==================== MENU VIEW (ROOT) ==================== -->
        <div id="menu-view" class="view-section">
            <header class="main-header">
                <div class="header-greeting">
                    <h1 class="greeting">Menu</h1>
                </div>
            </header>
            <main class="content-scroll">

                <!-- Identity Section -->
                <div class="card-stack">
                    <div class="action-card" onclick="navigateTo('profile-view')">
                        <div class="card-icon"
                            style="background: center / cover no-repeat url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%238E8E93%22/><text x=%2250%22 y=%2250%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2240%22 font-weight=%22bold%22>TA</text></svg>'); border-radius: 50%; width: 50px; height: 50px; margin-right: 12px;">
                        </div>
                        <div class="card-text">
                            <span class="card-title" style="font-size: 19px; font-weight: 600;">Nguyễn Thị Thu
                                Ánh</span>
                            <span style="font-size: 13px; color: var(--text-secondary);">thuanhnlt@fe.edu.vn</span>
                        </div>
                        <div class="card-arrow"><svg viewBox="0 0 24 24" class="chevron">
                                <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                            </svg></div>
                    </div>
                </div>

                <!-- Main Actions -->
                <div class="card-stack">
                    <div class="action-card" onclick="navigateTo('notifications-view')">
                        <div class="card-icon icon-red">
                            <svg viewBox="0 0 24 24" class="icon-svg">
                                <path fill="currentColor"
                                    d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z" />
                            </svg>
                        </div>
                        <div class="card-text"><span class="card-title">Thông báo</span></div>
                        <div class="card-arrow"><svg viewBox="0 0 24 24" class="chevron">
                                <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                            </svg></div>
                    </div>
                    <div class="action-card" onclick="navigateTo('settings-view')">
                        <div class="card-icon icon-gray">
                            <svg viewBox="0 0 24 24" class="icon-svg">
                                <path fill="currentColor"
                                    d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z" />
                            </svg>
                        </div>
                        <div class="card-text"><span class="card-title">Cài đặt</span></div>
                        <div class="card-arrow"><svg viewBox="0 0 24 24" class="chevron">
                                <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                            </svg></div>
                    </div>
                </div>

                <div class="card-stack">
                    <div class="action-card" onclick="confirmLogout()" style="color: var(--system-red);">
                        <div class="card-text" style="align-items: center;"><span class="card-title">Đăng xuất</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- ==================== PROFILE VIEW ==================== -->
        <div id="profile-view" class="view-section" style="display: none; transform: translateX(100%);">
            <header class="sub-header">
                <button class="back-button" onclick="goBack()">
                    <span class="back-text" style="color: var(--system-blue);">Hủy</span>
                </button>
                <div class="header-title">Hồ sơ</div>
                <div class="header-action" onclick="goBack()">Lưu</div>
            </header>
            <main class="content-scroll">
                <div class="profile-header-card">
                    <div style="position: relative;">
                        <div class="profile-avatar-large">TA</div>
                        <div
                            style="position: absolute; bottom: 0; right: 0; background: var(--system-blue); border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border: 2px solid white;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="white">
                                <path
                                    d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
                            </svg>
                        </div>
                    </div>
                    <div class="profile-name">Nguyễn Thị Thu Ánh</div>
                    <div class="profile-email">nguyenthithuanh.nlt@gmail.com</div>
                    <div class="profile-id">ThuAnh1349_IT</div>
                </div>

                <div class="section-title">THÔNG TIN CÁ NHÂN</div>
                <div class="card-stack form-stack">
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-blue);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                            </svg>
                        </div>
                        <label class="form-label">Họ và tên</label>
                        <input type="text" class="form-input" value="Nguyễn Thị Thu Ánh">
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-indigo);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm4.24 16L12 15.45 .77 17.95c-.27.27-.45.44-.06.7l5.05 1.57L17 7.02l-10.45 8.12 1.57 5.09c.27.42.43.21.7-.06l2.42-4.23z" />
                            </svg>
                        </div>
                        <label class="form-label">Biệt danh</label>
                        <input type="text" class="form-input" value="ThuAnh1349_IT">
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-green);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
                            </svg>
                        </div>
                        <label class="form-label">Số điện thoại</label>
                        <input type="tel" class="form-input" value="0354720185">
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-blue);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
                            </svg>
                        </div>
                        <label class="form-label">Telegram ID</label>
                        <input type="text" class="form-input" value="2090957996" readonly
                            style="color: var(--text-secondary);">
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-red);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                            </svg>
                        </div>
                        <label class="form-label">Địa chỉ</label>
                        <textarea class="form-textarea" rows="1"
                            style="flex: 1; text-align: right; padding-top: 2px;">Thanh Khê, Đà Nẵng</textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-teal);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M12 4c1.1 0 2 .9 2 2 0 .74-.4 1.39-1 1.73V9h4v2h-4v3h2v2h-2v1h-2v-1H9v-2h2v-3H7V9h4V7.73C10.4 7.39 10 6.74 10 6c0-1.1.9-2 2-2z" />
                            </svg>
                        </div>
                        <label class="form-label">Giới tính</label>
                        <select class="form-select">
                            <option value="female" selected>Nữ</option>
                            <option value="male">Nam</option>
                            <option value="other">Khác</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-icon-wrapper" style="margin-right: 12px; color: var(--system-orange);">
                            <svg viewBox="0 0 24 24" class="icon-svg-small" style="width: 20px; height: 20px;">
                                <path fill="currentColor"
                                    d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z" />
                            </svg>
                        </div>
                        <label class="form-label">Ngày sinh</label>
                        <input type="date" class="form-input" value="2002-05-15">
                    </div>
                </div>

                <div class="section-title">BẢO MẬT</div>
                <div class="card-stack">
                    <div class="action-card" onclick="navigateTo('change-password-view')"
                        style="display: flex; justify-content: space-between;">
                        <span style="font-size: 16px; color: var(--system-blue);">Đổi mật khẩu</span>
                        <div class="card-arrow"><svg viewBox="0 0 24 24" class="chevron">
                                <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                            </svg></div>
                    </div>
                </div>
                <div class="spacer" style="height: 50px;"></div>
            </main>
        </div>

        <!-- ==================== NOTIFICATIONS VIEW ==================== -->
        <div id="notifications-view" class="view-section" style="display: none; transform: translateX(100%);">
            <header class="sub-header">
                <button class="back-button" onclick="goBack()">
                    <svg viewBox="0 0 24 24" class="back-chevron">
                        <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                    </svg>
                    <span class="back-text">Menu</span>
                </button>
                <div class="header-title">Thông báo</div>
            </header>
            <main class="content-scroll">
                <div class="notification-setup-card">
                    <div class="setup-icon-circle">
                        <svg viewBox="0 0 24 24" class="icon-svg-large">
                            <path fill="currentColor"
                                d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" />
                        </svg>
                    </div>
                    <h2>Thiết lập thông báo</h2>
                    <p>Kết nối Telegram để nhận thông báo tức thời từ hệ thống NQuốc.</p>
                </div>

                <div class="section-title">BƯỚC 1: KẾT NỐI BOT</div>
                <div class="card-stack">
                    <div class="action-card" onclick="window.open('https://t.me/nquoc_bot', '_blank')">
                        <div class="card-icon icon-blue">
                            <svg viewBox="0 0 24 24" class="icon-svg">
                                <path fill="currentColor"
                                    d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
                            </svg>
                        </div>
                        <div class="card-text"><span class="card-title">Mở Telegram Bot</span></div>
                        <div class="card-arrow"><svg viewBox="0 0 24 24" class="chevron">
                                <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" />
                            </svg></div>
                    </div>
                </div>

                <div class="section-title">BƯỚC 2: LẤY ID NGƯỜI DÙNG</div>
                <div class="card-stack">
                    <div class="action-card">
                        <div class="card-icon icon-indigo">
                            <svg viewBox="0 0 24 24" class="icon-svg">
                                <path fill="currentColor"
                                    d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                            </svg>
                        </div>
                        <div class="card-text">
                            <span class="card-title">Gõ lệnh: <code
                                    style="background: rgba(0,0,0,0.1); padding: 2px 6px; border-radius: 4px;">/id</code></span>
                        </div>
                        <div class="card-arrow" onclick="alert('Đã copy lệnh!')"
                            style="color: var(--system-blue); font-weight: 600; font-size: 13px;">Copy</div>
                    </div>
                </div>
            </main>
        </div>

        <!-- ==================== SETTINGS VIEW (NEW) ==================== -->
        <div id="settings-view" class="view-section" style="display: none; transform: translateX(100%);">
            <header class="sub-header">
                <button class="back-button" onclick="goBack()">
                    <svg viewBox="0 0 24 24" class="back-chevron">
                        <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                    </svg>
                    <span class="back-text">Menu</span>
                </button>
                <div class="header-title">Cài đặt</div>
            </header>
            <main class="content-scroll">
                <div class="section-title">GIAO DIỆN HIỂN THỊ</div>
                <div class="card-stack">
                    <div class="action-card" onclick="toggleDarkMode()">
                        <div class="card-icon icon-gray">
                            <svg viewBox="0 0 24 24" class="icon-svg">
                                <path fill="currentColor"
                                    d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z" />
                            </svg>
                        </div>
                        <div class="card-text"><span class="card-title">Chế độ tối</span></div>
                        <!-- Toggle Switch -->
                        <div class="toggle-switch" id="theme-toggle" role="switch" aria-checked="false">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- ==================== CHANGE PASSWORD VIEW (NEW) ==================== -->
        <div id="change-password-view" class="view-section" style="display: none; transform: translateX(100%);">
            <header class="sub-header">
                <button class="back-button" onclick="goBack()">
                    <svg viewBox="0 0 24 24" class="back-chevron">
                        <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                    </svg>
                    <span class="back-text">Hồ sơ</span>
                </button>
                <div class="header-title">Đổi mật khẩu</div>
                <div class="header-action" onclick="submitChangePassword()">Hoàn tất</div>
            </header>
            <main class="content-scroll">
                <div class="section-title" style="margin-top: 32px;">MẬT KHẨU HIỆN TẠI</div>
                <div class="card-stack form-stack">
                    <div class="form-row" style="position: relative;">
                        <input type="password" class="form-input" id="current-password"
                            placeholder="Nhập mật khẩu hiện tại" style="text-align: left; padding-right: 40px;">
                        <div class="password-toggle" onclick="togglePasswordVisibility('current-password', this)">
                            <svg viewBox="0 0 24 24" class="icon-svg-small">
                                <path fill="currentColor"
                                    d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="section-title">MẬT KHẨU MỚI</div>
                <div class="card-stack form-stack">
                    <div class="form-row" style="position: relative;">
                        <input type="password" class="form-input" id="new-password" placeholder="Nhập mật khẩu mới"
                            style="text-align: left; padding-right: 40px;">
                        <div class="password-toggle" onclick="togglePasswordVisibility('new-password', this)">
                            <svg viewBox="0 0 24 24" class="icon-svg-small">
                                <path fill="currentColor"
                                    d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                            </svg>
                        </div>
                    </div>
                    <div class="form-row" style="position: relative;">
                        <input type="password" class="form-input" id="confirm-password"
                            placeholder="Nhập lại mật khẩu mới" style="text-align: left; padding-right: 40px;">
                        <div class="password-toggle" onclick="togglePasswordVisibility('confirm-password', this)">
                            <svg viewBox="0 0 24 24" class="icon-svg-small">
                                <path fill="currentColor"
                                    d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                            </svg>
                        </div>
                    </div>
                </div>

                <p style="margin: 0 32px; font-size: 13px; color: var(--text-secondary);">Mật khẩu mới phải có ít nhất 8
                    ký tự, bao gồm chữ hoa, chữ thường và số.</p>
            </main>
        </div>

    </div>

    <script>
        // Navigation Logic
        const viewStack = ['menu-view'];

        function navigateTo(targetId) {
            const target = document.getElementById(targetId);
            if (target) {
                target.style.display = 'flex';
                // Trigger reflow
                target.offsetHeight;
                target.style.transform = 'translateX(0)';
                target.style.transition = 'transform 0.3s cubic-bezier(0.25, 1, 0.5, 1)';
                target.style.zIndex = '100';

                viewStack.push(targetId);
            }
        }

        function goBack() {
            if (viewStack.length > 1) {
                const currentId = viewStack.pop();
                const current = document.getElementById(currentId);

                // Slide out to right
                current.style.transform = 'translateX(100%)';

                // Hide after animation
                setTimeout(() => {
                    if (!viewStack.includes(currentId)) {
                        current.style.display = 'none';
                        current.style.zIndex = 'auto';
                    }
                }, 300);
            }
        }

        function confirmLogout() {
            if (confirm('Bạn có chắc chắn muốn đăng xuất?')) {
                alert('Đã đăng xuất (Mock)');
            }
        }

        function submitChangePassword() {
            const current = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirmPass = document.getElementById('confirm-password').value;

            if (!current || !newPass || !confirmPass) {
                alert('Vui lòng điền đầy đủ thông tin!');
                return;
            }
            if (newPass !== confirmPass) {
                alert('Mật khẩu mới không khớp!');
                return;
            }
            if (newPass.length < 8) {
                alert('Mật khẩu phải có ít nhất 8 ký tự!');
                return;
            }

            alert('Đổi mật khẩu thành công (Mock)!');
            goBack();
        }

        function togglePasswordVisibility(inputId, toggleIcon) {
            const input = document.getElementById(inputId);
            const iconSvg = toggleIcon.querySelector('svg path');

            if (input.type === 'password') {
                input.type = 'text';
                // Switch to "Visibility Off" icon (Slash)
                iconSvg.setAttribute('d', 'M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-4 .7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z');
                toggleIcon.style.color = 'var(--text-primary)';
            } else {
                input.type = 'password';
                // Switch back to "Visibility" icon (Eye)
                iconSvg.setAttribute('d', 'M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z');
                toggleIcon.style.color = 'var(--text-secondary)';
            }
        }

        // Dark Mode Logic
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        // Check Local Storage or System Preference
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                enableDarkMode();
            } else if (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                enableDarkMode();
            }
        }

        function enableDarkMode() {
            body.classList.add('dark-mode');
            themeToggle.setAttribute('aria-checked', 'true');
            localStorage.setItem('theme', 'dark');
        }

        function disableDarkMode() {
            body.classList.remove('dark-mode');
            themeToggle.setAttribute('aria-checked', 'false');
            localStorage.setItem('theme', 'light');
        }

        function toggleDarkMode() {
            if (body.classList.contains('dark-mode')) {
                disableDarkMode();
            } else {
                enableDarkMode();
            }
        }

        // Initialize on load
        initTheme();
    </script>
</body>

</html>